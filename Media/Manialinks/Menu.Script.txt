#RequireContext CManiaAppTitle
//#RequireContext CModuleMenuComponent
#Include "TextLib" as TextLib
#Const ScriptName "Menu.Script.txt"

Text MainView() {
	return "file://media/manialinks/menu2.xml";
}
	
main() {
	
	declare ShowSoloRanking = False;
	declare Layer = UILayerCreate();
	//declare LoadscreenMap = UILayerCreate();
	declare LayerSolo = UILayerCreate();
	declare LayerSoloRank = UILayerCreate();
	declare LayerProfile = UILayerCreate();
	
	//LayerSoloRank.ManialinkPage ="file://Media/Manialinks/rank2.xml";
	//LoadscreenMap.ManialinkPage ="file://Media/Manialinks/maploadscreen.xml";

	LayerProfile.ManialinkPage ="file://Media/Manialinks/profile.xml";
	Layer.ManialinkPage = MainView();
	LayerSolo.ManialinkPage = "file://Media/Manialinks/PlatformCampaignFull.xml";
	
	LayerSolo.IsVisible = False;
	LayerSoloRank.IsVisible = False;
	LayerProfile.IsVisible = False;

	LayerSoloRank.InOutAnimation = CUILayer::EUILayerAnimation::RightFast;

	declare persistent IsChoosedCol for LocalUser = False;
	
	DontScaleMainMenuForHMD = False;
	log(TextLib::Split(LocalUser.ZonePath,"|").count > 0);
	
	 
		
		while(True) {		
			log(IsChoosedCol);
			if(!IsChoosedCol && LayerSolo.IsVisible)
				ShowSoloRanking = True;
			else
				ShowSoloRanking = False;
			
			if (ShowSoloRanking)
				LayerSoloRank.IsVisible = True;
			else
				LayerSoloRank.IsVisible = False;
				
		yield;

		
		
		
		wait(TitleFlow.IsReady);
			foreach (Event in PendingEvents) {
			if (Event.Type == CManiaAppEvent::EType::LayerCustomEvent) {
				
				if (Event.CustomEventType == "menu_solo") {
					
					Layer.IsVisible = False;
					LayerSolo.IsVisible = True;
					LayerSolo.ManialinkPage = "file://Media/Manialinks/PlatformCampaignFull.xml";
				}
				if (Event.CustomEventType == "menu_profile") {
					
					Layer.IsVisible = False;
					LayerProfile.IsVisible = True;
				}
				if (Event.CustomEventType == "menu_main") {				
					Layer.IsVisible = True;
					LayerSolo.IsVisible = False;
					LayerProfile.IsVisible = False;
					ShowSoloRanking = False;
					LayerSolo.ManialinkPage = "";
				}
				if (Event.CustomEventType == "hide_rank") {
					ShowSoloRanking = False;
				}
				if (Event.CustomEventType == "show_rank") {
					ShowSoloRanking = True;
				}	
			}
		}
	}
}
